---
title: "Hexmap: Week 0x19"
date: 2025-06-29
categories:
- hexmap
---

So, I want to know what "administative" regions each hex belongs to, so I can give them default names and eventually offer area completion stats.

WHen you research "where is this point" you will find that the common usecase of _reverse geocoding_ is to find the nearest POI so geocordinates can be turned into postal addresses.   are the big open source players in geocoding, and there are countless API services. Very few of these even recognize that I might want a random location in a boring area to be labeled as such, but [Geocode Earth has a nice explainer](https://geocode.earth/docs/reverse/reverse/) that introduced me to the term _coarse reverse geocoding_, and [BigDataCloud also uses point-in-polygon lookups](https://www.bigdatacloud.com/reverse-geocoding/reverse-geocode-to-city-api).

So I needed _coarse_ point-in-polygon lookups, and spent a couple days prototyping with various APIs that offer this. Most of the hosted options are meant for heavier tasks and have pricing to match so I cannot afford them at scale. Self-hosting [Pelias](https://pelias.io/) (which Geocode Earth is based on) or [Nominatim](https://nominatim.org/) (perhaps as part of [Photon](https://photon.komoot.io/)) would be sensible, but prototyping with these I quickly ended up in devops/sysadmin land that smells like a brittle future for my one-person side project.

Also the polygons themselves might be from [OSM](https://www.openstreetmap.org/about), [Natural Earth](https://www.naturalearthdata.com/), [GeoNames](https://www.geonames.org/), or [Who's On First](https://www.whosonfirst.org). OpenStreetMap is an obvious choice, as I also want to host my own map tiles for vector rendering and there is effectively no other viable source for map data. It would keep things tidy to use a single source for map data and one workflow to update it.

But, OSM's administrative boundaries are messy. They overlap, the heirarchies vary by region, etc.[^osm] For my purposes, the relatively simple taxonomy of [Who's On First placetypes](https://github.com/whosonfirst/whosonfirst-placetypes) is preferable. Plus, I have a soft spot for WOF as I took part in early discussions about how it might track historic changes. (WOF really stands out as a history-aware gazetteer, though I don't care about that for Hexmap.)

[^osm]: This is no complaint! OSM seeks to map reality, and reality is messy. By treating administrative boundaries as labels, they are doing the right thing both for mapping the real world and for keeping the project as inclusive as possible.
